;************************************************************************
;Функция преобразует кирилические символы в ANSI кодировке в символы,	*
;пригодные для использования в символьных дисплеях WH XXXX.				*
;Вход:			R16														*
;Выход:			R16														*
;Портит			R17														*
;Автор: Елисей, 2011													*
;************************************************************************
.equ	begin_of_cyr 	=	0x80

ansi2lcd:		LDI		R17,begin_of_cyr
                CP		R17,R16
                BRPL	_a2l_exit

_a2l_change:	SUBI	R16,0x80

                LDI		ZL, low(2*_a2l_TabRus)
                LDI		ZH, high(2*_a2l_TabRus)

                ADD		ZL,R16
                CLR		R17
                ADC		ZH,R17

                LPM		R16,Z

_a2l_exit:		RET

_a2l_TabRus:		.db		0xc8, 0xc9, 0xca, 0xcb, 0xcc, 0xcd, 0xce, 0xcf
                    .db		0xd0, 0xd1, 0xd2, 0xd3, 0xd4, 0xd5, 0xd6, 0xd7
                    .db		0xd8, 0xd9, 0xda, 0xdb, 0xdc, 0xdd, 0xde, 0xdf
                    .db		0xe7, 0xe8, 0xe9, 0xea, 0xeb, 0xec, 0xed, 0xee
                    .db		0xef, 0xf0, 0xf1, 0xf2, 0xf3, 0xf4, 0xf5, 0xf6
                    .db		0xa2, 0xf7, 0xf8, 0xf9, 0xfa, 0xfb, 0xfc, 0xfd
                    .db		0xfe, 0xff, 0xe7, 0xe8, 0xe9, 0xea, 0xeb, 0xec
                    .db		0xb5, 0xee, 0xef, 0xf0, 0xf1, 0xf2, 0xfd, 0xff
                    .db		0x41, 0xa0, 0x42, 0xa1, 0xe0, 0x45, 0xa3, 0xa4
                    .db		0xa5, 0xa6, 0x4b, 0xa7, 0x4d, 0x48, 0x4f, 0xa8
                    .db		0x50, 0x43, 0x54, 0xa9, 0xaa, 0x58, 0xe1, 0xab
                    .db		0xac, 0xe2, 0xad, 0xae, 0x62, 0xaf, 0xb0, 0xb1
                    .db		0x61, 0xb2, 0xb3, 0xb4, 0xe3, 0x65, 0xb6, 0xb7
                    .db		0xb8, 0xb9, 0xba, 0xbb, 0xbc, 0xbd, 0x6f, 0xbe
                    .db		0x70, 0x63, 0xbf, 0x79, 0xe4, 0x78, 0xe5, 0xc0
                    .db		0xc1, 0xe6, 0xc2, 0xc3, 0xc4, 0xc5, 0xc6, 0xc7
